import{g,k as y,r as d,n as k,c as a,a as r,F as v,s as x,o,H as h,d as m,t as n,N as b}from"./C4cmwJeW.js";const f={class:"container mx-auto p-4"},N={key:0,class:"text-center"},C={key:1,class:"text-center text-red-500"},$={key:2,class:"text-center text-gray-500"},F={key:3},w=["onClick"],B={class:"text-gray-600 dark:text-gray-300"},D={class:"text-gray-400"},V=g({__name:"notifications",setup(L){const{$api:c}=y(),l=d([]),i=d(!0),u=d(null),_=async()=>{try{const e=await c.get("/notifications/");l.value=e.data.results}catch(e){u.value="Failed to load notifications.",console.error(e)}finally{i.value=!1}},p=async e=>{if(!e.is_read)try{await c.post(`/notifications/${e.id}/mark-as-read/`),e.is_read=!0}catch(t){console.error("Failed to mark notification as read",t)}b(`/community/posts/${e.post.id}#comment-${e.comment.id}`)};return k(_),(e,t)=>(o(),a("div",f,[t[2]||(t[2]=r("h1",{class:"text-2xl font-bold mb-4"},"消息中心",-1)),i.value?(o(),a("div",N,"加载中...")):u.value?(o(),a("div",C,"加载失败")):l.value.length===0?(o(),a("div",$,"暂无消息")):(o(),a("div",F,[(o(!0),a(v,null,x(l.value,s=>(o(),a("div",{key:s.id,class:h(["p-4 mb-4 border rounded-lg cursor-pointer",{"bg-gray-100 dark:bg-gray-800":s.is_read}]),onClick:S=>p(s)},[r("p",null,[r("strong",null,n(s.sender.nickname||s.sender.username),1),t[0]||(t[0]=m(" 在帖子 ",-1)),r("strong",null,n(s.post.title),1),t[1]||(t[1]=m(" 中回复了你: ",-1))]),r("p",B,n(s.comment.body),1),r("small",D,n(new Date(s.created_at).toLocaleString()),1)],10,w))),128))]))]))}});export{V as default};
