import{_ as P}from"./pP1PrXx_.js";import{d as V,_ as z,a as H,b as S,c as j}from"./Bnx0PPvk.js";import{_ as q}from"./DLa9Lqb7.js";import{_ as I}from"./38tOet_I.js";import{_ as R}from"./DzNSn88N.js";import{_ as G}from"./CCRcQfJ_.js";import{_ as J}from"./D3KgOzdW.js";import{g as K,a1 as M,k as O,r as g,m as Q,C as U,c as u,b as t,v as r,a as s,w as o,t as a,o as i,d as l,F as W,s as X,p as Y,N as Z}from"./C4cmwJeW.js";import"./CTtaAHph.js";const ee={class:"space-y-6"},te={key:0,class:"grid gap-6 lg:grid-cols-[2fr_1fr]"},se={class:"space-y-6"},oe={class:"flex flex-wrap items-center gap-3 text-xs text-muted-foreground"},re={class:"grid gap-4 md:grid-cols-2"},ne={class:"rounded-lg border border-dashed border-border/60 bg-muted/30 p-3 text-xs text-muted-foreground"},ae={key:0},le={key:1},de={key:2},ie={key:0,class:"rounded-lg border border-dashed border-border/70 p-4 text-sm text-muted-foreground"},ue={key:1,class:"rounded-lg border border-dashed border-border/70 p-4 text-sm text-muted-foreground"},me={key:2,class:"rounded-lg border border-dashed border-border/70 p-4 text-sm text-muted-foreground"},_e={key:3,class:"space-y-4"},ce={class:"line-clamp-3 whitespace-pre-line leading-relaxed"},pe={class:"flex items-center gap-4 text-muted-foreground"},fe={class:"flex items-center gap-1"},xe={class:"flex items-center gap-1"},ge={class:"space-y-4"},ye={key:1,class:"rounded-lg border border-dashed border-border/70 p-6 text-sm text-muted-foreground"},Te=K({__name:"[username]",setup(be){const v=M(),{$api:$}=O(),n=g(null),k=g(null),y=g([]),h=g(!1),b=g(null),N=Q(()=>{if(!n.value)return"未知";switch(n.value.profile_visibility){case"private":return"私密主页";case"friends":return"半公开";default:return"公开主页"}}),B=async()=>{k.value=null;try{const{data:d}=await $.get(`/community/users/${v.params.username}/`);n.value=d}catch(d){const e=d;n.value=null,k.value=e.response?.data?.detail||"无法获取该用户信息"}},E=async()=>{h.value=!0,b.value=null;try{const{data:d}=await $.get(`/community/users/${v.params.username}/posts/`);y.value=Array.isArray(d)?d:d.results||[]}catch(d){const e=d;y.value=[],b.value=e.response?.data?.detail||"无法获取帖子列表"}finally{h.value=!1}},L=d=>{try{return new Date(d).toLocaleString("zh-CN",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return d}};return U(()=>v.params.username,async()=>{await B(),await E()},{immediate:!0}),(d,e)=>{const T=P,_=H,c=S,w=q,p=z,f=j,x=V,D=I,C=R,A=G,F=J;return i(),u("div",ee,[t(T,{title:"社区名片",description:"查看用户在社区内的贡献与动态"}),r(n)?(i(),u("div",te,[s("section",se,[t(x,{class:"border border-border/70"},{default:o(()=>[t(p,{class:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between"},{default:o(()=>[s("div",null,[t(_,{class:"text-2xl"},{default:o(()=>[l(a(r(n).nickname||r(n).username),1)]),_:1}),t(c,{class:"text-sm"},{default:o(()=>[l(a(r(n).is_self?"这是你的公共主页":`@${r(n).username}`),1)]),_:1})]),s("div",oe,[t(w,{variant:"outline"},{default:o(()=>[l(a(r(N)),1)]),_:1}),t(w,{variant:"outline"},{default:o(()=>[l("帖子 "+a(r(n).community_stats.posts_published),1)]),_:1}),t(w,{variant:"outline"},{default:o(()=>[l("评论 "+a(r(n).community_stats.comments_written),1)]),_:1})])]),_:1}),t(f,{class:"space-y-3 text-sm"},{default:o(()=>[s("div",re,[s("div",null,[e[0]||(e[0]=s("p",{class:"text-xs text-muted-foreground"},"邮箱",-1)),s("p",null,a(r(n).email||"未公开"),1)]),s("div",null,[e[1]||(e[1]=s("p",{class:"text-xs text-muted-foreground"},"手机号",-1)),s("p",null,a(r(n).phone_number||"未公开"),1)]),s("div",null,[e[2]||(e[2]=s("p",{class:"text-xs text-muted-foreground"},"帖子获赞",-1)),s("p",null,a(r(n).community_stats.post_likes_received),1)]),s("div",null,[e[3]||(e[3]=s("p",{class:"text-xs text-muted-foreground"},"评论获赞",-1)),s("p",null,a(r(n).community_stats.comment_likes_received),1)])]),s("div",ne,[s("p",null,[e[4]||(e[4]=l("隐私设置： ",-1)),r(n).profile_visibility==="private"?(i(),u("span",ae,"仅本人可见")):r(n).profile_visibility==="friends"?(i(),u("span",le,"仅授权用户可见")):(i(),u("span",de,"公开主页"))]),s("p",null,"展示邮箱："+a(r(n).show_email?"是":"否")+" · 展示手机号："+a(r(n).show_phone?"是":"否"),1)])]),_:1})]),_:1}),t(x,{class:"border border-border/70"},{default:o(()=>[t(p,null,{default:o(()=>[t(_,null,{default:o(()=>[...e[5]||(e[5]=[l("最近发表",-1)])]),_:1}),t(c,null,{default:o(()=>[...e[6]||(e[6]=[l("浏览该用户最近的帖子与互动",-1)])]),_:1})]),_:1}),t(f,null,{default:o(()=>[r(b)?(i(),u("div",ie,a(r(b)),1)):r(h)?(i(),u("div",ue," 正在加载帖子… ")):r(y).length?(i(),u("div",_e,[(i(!0),u(W,null,X(r(y),m=>(i(),Y(x,{key:m.id,class:"border border-border/70"},{default:o(()=>[t(p,null,{default:o(()=>[t(_,{class:"text-lg"},{default:o(()=>[l(a(m.title),1)]),_:2},1024),t(c,null,{default:o(()=>[e[7]||(e[7]=l(" 发布于 ",-1)),t(D,{to:`/community/${m.community_detail.slug}`,class:"font-medium hover:underline"},{default:o(()=>[l(a(m.community_detail.name),1)]),_:2},1032,["to"]),l(" · "+a(L(m.created_at)),1)]),_:2},1024)]),_:2},1024),t(f,{class:"space-y-3 text-sm"},{default:o(()=>[s("p",ce,a(m.body),1),s("div",pe,[s("span",fe,[t(C,{name:"lucide:heart",class:"h-4 w-4"}),l(a(m.like_count),1)]),s("span",xe,[t(C,{name:"lucide:message-square",class:"h-4 w-4"}),l(a(m.comment_count),1)])])]),_:2},1024),t(F,null,{default:o(()=>[t(A,{variant:"ghost",size:"sm",onClick:ve=>("navigateTo"in d?d.navigateTo:r(Z))(`/community/posts/${m.id}`)},{default:o(()=>[...e[8]||(e[8]=[l("查看详情",-1)])]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024))),128))])):(i(),u("div",me," 暂无帖子。 "))]),_:1})]),_:1})]),s("aside",ge,[t(x,{class:"border border-border/70 bg-secondary/20"},{default:o(()=>[t(p,null,{default:o(()=>[t(_,null,{default:o(()=>[...e[9]||(e[9]=[l("社区积分",-1)])]),_:1}),t(c,null,{default:o(()=>[...e[10]||(e[10]=[l("统计来自公开互动的数据",-1)])]),_:1})]),_:1}),t(f,{class:"space-y-2 text-sm"},{default:o(()=>[s("p",null,"帖子数量："+a(r(n).community_stats.posts_published),1),s("p",null,"评论数量："+a(r(n).community_stats.comments_written),1),s("p",null,"帖子获赞："+a(r(n).community_stats.post_likes_received),1),s("p",null,"评论获赞："+a(r(n).community_stats.comment_likes_received),1)]),_:1})]),_:1}),t(x,{class:"border border-border/70"},{default:o(()=>[t(p,null,{default:o(()=>[t(_,null,{default:o(()=>[...e[11]||(e[11]=[l("互动力度",-1)])]),_:1}),t(c,null,{default:o(()=>[...e[12]||(e[12]=[l("了解该用户在社区的参与趋势",-1)])]),_:1})]),_:1}),t(f,{class:"space-y-2 text-xs text-muted-foreground"},{default:o(()=>[...e[13]||(e[13]=[s("p",null,"· 若主页设为私密，只有本人及管理员可见详细资料。",-1),s("p",null,"· 帖子与评论获赞越多，可信度越高。",-1),s("p",null,"· 设置隐私字段可控制邮箱和手机号是否公开。",-1)])]),_:1})]),_:1})])])):(i(),u("div",ye,a(r(k)||"正在加载用户资料…"),1))])}}});export{Te as default};
